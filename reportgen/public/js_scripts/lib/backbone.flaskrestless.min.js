var __hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};!function($,_,Backbone){Backbone.FlaskRestless={defaultlimit:20};Backbone.FlaskRestless.Model=function(_super){__extends(Model,_super);function Model(){return Model.__super__.constructor.apply(this,arguments)}Model.prototype.format=function(object){return object};Model.prototype.parse=function(response){return this.format(response)};return Model}(Backbone.Model);Backbone.FlaskRestless.Collection=function(_super){__extends(Collection,_super);function Collection(){return Collection.__super__.constructor.apply(this,arguments)}Collection.prototype.current_page=-1;Collection.prototype.number_of_pages=-1;Collection.prototype.format=function(objects){return objects};Collection.prototype.parse=function(response){if(response.objects){this.current_page=response.page;this.number_of_pages=response.total_pages;return this.format(response.objects)}else{return this.format(response)}};Collection.prototype.has_next=function(){return this.current_page<this.number_of_pages};Collection.prototype.splice=function(index,howMany){var args,removed;args=_.toArray(arguments).slice(2).concat({at:index});removed=this.models.slice(index,index+howMany);this.remove(removed).add.apply(this,args);return removed};return Collection}(Backbone.Collection);Backbone.FlaskRestless.Filter=function(_super){__extends(Filter,_super);function Filter(){return Filter.__super__.constructor.apply(this,arguments)}Filter.prototype.defaults={name:"",op:"",val:""};return Filter}(Backbone.Model);Backbone.FlaskRestless.SearchOptions=function(){function SearchOptions(){this.query={};this.options={}}SearchOptions.prototype.setOptions=function(options){this.options=options};SearchOptions.prototype.setFilters=function(filters){return this.query["filters"]=filters};SearchOptions.prototype.setOrderby=function(orderby){return this.query["order_by"]=[orderby]};SearchOptions.prototype.getOptions=function(){var q;q={q:JSON.stringify(this.query)};this.options["data"]=q;return this.options};return SearchOptions}();return Backbone.FlaskRestless.CollectionIterator=function(){function CollectionIterator(collection){this.collection=collection;this.query="";this.current_page=this.collection.current_page;this.items_per_page=25;this.options={reset:true}}CollectionIterator.prototype.set_items_per_page=function(items_per_page){this.items_per_page=items_per_page};CollectionIterator.prototype.search=function(filters,order_by,options){this.query={filters:filters};_.extend(this.options,options);if(order_by!==null){this.query["order_by"]=order_by}return this.do_search()};CollectionIterator.prototype.search_again=function(){return this.do_search()};CollectionIterator.prototype.next_page=function(){var next_page;this.current_page=this.collection.current_page;next_page=current_page+1;if(next_page<=this.collection.number_of_pages){this.current_page=next_page+"";$("#left",this.$el).removeClass("active");return this.do_search()}};CollectionIterator.prototype.previous_page=function(){var current_page,previous_page;current_page=this.collection.current_page;previous_page=current_page-1;if(previous_page>=1){this.current_page=previous_page+"";$("#right",this.$el).removeClass("active")}return this.do_search()};CollectionIterator.prototype.do_search=function(){var q;this.query["results_per_page"]=this.items_per_page;this.query["page"]=this.current_page;if(this.query){q={q:JSON.stringify(this.query)};this.options["data"]=q}this.options["reset"]=true;return this.collection.fetch(this.options)};return CollectionIterator}()}(window.$,window._,window.Backbone);